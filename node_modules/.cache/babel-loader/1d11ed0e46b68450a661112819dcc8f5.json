{"remainingRequest":"/Users/shl/Desktop/Moss罗杰软工/frontend/buaa2022-db/node_modules/babel-loader/lib/index.js!/Users/shl/Desktop/Moss罗杰软工/frontend/buaa2022-db/node_modules/eslint-loader/index.js??ref--13-0!/Users/shl/Desktop/Moss罗杰软工/frontend/buaa2022-db/src/permission.js","dependencies":[{"path":"/Users/shl/Desktop/Moss罗杰软工/frontend/buaa2022-db/src/permission.js","mtime":1680948092945},{"path":"/Users/shl/Desktop/Moss罗杰软工/frontend/buaa2022-db/babel.config.js","mtime":1680943788576},{"path":"/Users/shl/Desktop/Moss罗杰软工/frontend/buaa2022-db/node_modules/cache-loader/dist/cjs.js","mtime":1680943968418},{"path":"/Users/shl/Desktop/Moss罗杰软工/frontend/buaa2022-db/node_modules/babel-loader/lib/index.js","mtime":1680943970633},{"path":"/Users/shl/Desktop/Moss罗杰软工/frontend/buaa2022-db/node_modules/eslint-loader/index.js","mtime":1680943968496}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiL1VzZXJzL3NobC9EZXNrdG9wL01vc3NcdTdGNTdcdTY3NzBcdThGNkZcdTVERTUvZnJvbnRlbmQvYnVhYTIwMjItZGIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3JlZ2VuZXJhdG9yUnVudGltZS5qcyI7CmltcG9ydCBfb2JqZWN0U3ByZWFkIGZyb20gIi9Vc2Vycy9zaGwvRGVza3RvcC9Nb3NzXHU3RjU3XHU2NzcwXHU4RjZGXHU1REU1L2Zyb250ZW5kL2J1YWEyMDIyLWRiL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyLmpzIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9zaGwvRGVza3RvcC9Nb3NzXHU3RjU3XHU2NzcwXHU4RjZGXHU1REU1L2Zyb250ZW5kL2J1YWEyMDIyLWRiL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yLmpzIjsKaW1wb3J0IHJvdXRlciBmcm9tICcuL3JvdXRlcic7CmltcG9ydCBzdG9yZSBmcm9tICcuL3N0b3JlJzsKaW1wb3J0IHsgTWVzc2FnZSB9IGZyb20gJ2VsZW1lbnQtdWknOwppbXBvcnQgTlByb2dyZXNzIGZyb20gJ25wcm9ncmVzcyc7IC8vIHByb2dyZXNzIGJhcgppbXBvcnQgJ25wcm9ncmVzcy9ucHJvZ3Jlc3MuY3NzJzsgLy8gcHJvZ3Jlc3MgYmFyIHN0eWxlCmltcG9ydCB7IGdldFRva2VuIH0gZnJvbSAnQC91dGlscy9hdXRoJzsgLy8gZ2V0IHRva2VuIGZyb20gY29va2llCmltcG9ydCBnZXRQYWdlVGl0bGUgZnJvbSAnQC91dGlscy9nZXQtcGFnZS10aXRsZSc7Ck5Qcm9ncmVzcy5jb25maWd1cmUoewogIHNob3dTcGlubmVyOiBmYWxzZQp9KTsgLy8gTlByb2dyZXNzIENvbmZpZ3VyYXRpb24KCnZhciB3aGl0ZUxpc3QgPSBbJy9pbmRleDInLCAnL2xvZ2luJywgJy9hdXRoLXJlZGlyZWN0J107IC8vIG5vIHJlZGlyZWN0IHdoaXRlbGlzdAoKcm91dGVyLmJlZm9yZUVhY2goIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgdmFyIF9yZWYgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUodG8sIGZyb20sIG5leHQpIHsKICAgIHZhciBoYXNUb2tlbiwgaGFzUm9sZXMsIHJvbGVzLCBhY2Nlc3NSb3V0ZXM7CiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICAvLyBzdGFydCBwcm9ncmVzcyBiYXIKICAgICAgICAgIE5Qcm9ncmVzcy5zdGFydCgpOwoKICAgICAgICAgIC8vIHNldCBwYWdlIHRpdGxlCiAgICAgICAgICBkb2N1bWVudC50aXRsZSA9IGdldFBhZ2VUaXRsZSh0by5tZXRhLnRpdGxlKTsKCiAgICAgICAgICAvLyBkZXRlcm1pbmUgd2hldGhlciB0aGUgdXNlciBoYXMgbG9nZ2VkIGluCiAgICAgICAgICBoYXNUb2tlbiA9IGdldFRva2VuKCk7CiAgICAgICAgICBpZiAoIWhhc1Rva2VuKSB7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzNDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoISh0by5wYXRoID09PSAnL2xvZ2luJykpIHsKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgICAgLy8gaWYgaXMgbG9nZ2VkIGluLCByZWRpcmVjdCB0byB0aGUgaG9tZSBwYWdlCiAgICAgICAgICBuZXh0KHsKICAgICAgICAgICAgcGF0aDogJy8nCiAgICAgICAgICB9KTsKICAgICAgICAgIE5Qcm9ncmVzcy5kb25lKCk7IC8vIGhhY2s6IGh0dHBzOi8vZ2l0aHViLmNvbS9QYW5KaWFDaGVuL3Z1ZS1lbGVtZW50LWFkbWluL3B1bGwvMjkzOQogICAgICAgICAgX2NvbnRleHQubmV4dCA9IDMyOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSA5OgogICAgICAgICAgLy8gZGV0ZXJtaW5lIHdoZXRoZXIgdGhlIHVzZXIgaGFzIG9idGFpbmVkIGhpcyBwZXJtaXNzaW9uIHJvbGVzIHRocm91Z2ggZ2V0SW5mbwogICAgICAgICAgaGFzUm9sZXMgPSBzdG9yZS5nZXR0ZXJzLnJvbGVzICYmIHN0b3JlLmdldHRlcnMucm9sZXMubGVuZ3RoID4gMDsKICAgICAgICAgIGlmICghaGFzUm9sZXMpIHsKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE0OwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICAgIG5leHQoKTsKICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzMjsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTQ7CiAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTc7CiAgICAgICAgICByZXR1cm4gc3RvcmUuZGlzcGF0Y2goJ3VzZXIvZm9yY2VHZXRJbmZvJyk7CiAgICAgICAgY2FzZSAxNzoKICAgICAgICAgIHJvbGVzID0gc3RvcmUuZ2V0dGVycy5yb2xlczsgLy8gZ2VuZXJhdGUgYWNjZXNzaWJsZSByb3V0ZXMgbWFwIGJhc2VkIG9uIHJvbGVzCiAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjA7CiAgICAgICAgICByZXR1cm4gc3RvcmUuZGlzcGF0Y2goJ3Blcm1pc3Npb24vZ2VuZXJhdGVSb3V0ZXMnLCByb2xlcyk7CiAgICAgICAgY2FzZSAyMDoKICAgICAgICAgIGFjY2Vzc1JvdXRlcyA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAvLyBkeW5hbWljYWxseSBhZGQgYWNjZXNzaWJsZSByb3V0ZXMKICAgICAgICAgIHJvdXRlci5hZGRSb3V0ZXMoYWNjZXNzUm91dGVzKTsKCiAgICAgICAgICAvLyBoYWNrIG1ldGhvZCB0byBlbnN1cmUgdGhhdCBhZGRSb3V0ZXMgaXMgY29tcGxldGUKICAgICAgICAgIC8vIHNldCB0aGUgcmVwbGFjZTogdHJ1ZSwgc28gdGhlIG5hdmlnYXRpb24gd2lsbCBub3QgbGVhdmUgYSBoaXN0b3J5IHJlY29yZAogICAgICAgICAgbmV4dChfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHRvKSwge30sIHsKICAgICAgICAgICAgcmVwbGFjZTogdHJ1ZQogICAgICAgICAgfSkpOwogICAgICAgICAgX2NvbnRleHQubmV4dCA9IDMyOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAyNToKICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAyNTsKICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHRbImNhdGNoIl0oMTQpOwogICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI5OwogICAgICAgICAgcmV0dXJuIHN0b3JlLmRpc3BhdGNoKCd1c2VyL3Jlc2V0VG9rZW4nKTsKICAgICAgICBjYXNlIDI5OgogICAgICAgICAgTWVzc2FnZS5lcnJvcih7CiAgICAgICAgICAgIG1lc3NhZ2U6IF9jb250ZXh0LnQwIHx8ICdIYXMgRXJyb3InCiAgICAgICAgICB9KTsKICAgICAgICAgIG5leHQoIi9sb2dpbj9yZWRpcmVjdD0iLmNvbmNhdCh0by5wYXRoKSk7CiAgICAgICAgICBOUHJvZ3Jlc3MuZG9uZSgpOwogICAgICAgIGNhc2UgMzI6CiAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzU7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDM0OgogICAgICAgICAgLyogaGFzIG5vIHRva2VuKi8KCiAgICAgICAgICBpZiAod2hpdGVMaXN0LmluZGV4T2YodG8ucGF0aCkgIT09IC0xKSB7CiAgICAgICAgICAgIC8vIGluIHRoZSBmcmVlIGxvZ2luIHdoaXRlbGlzdCwgZ28gZGlyZWN0bHkKICAgICAgICAgICAgbmV4dCgpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gb3RoZXIgcGFnZXMgdGhhdCBkbyBub3QgaGF2ZSBwZXJtaXNzaW9uIHRvIGFjY2VzcyBhcmUgcmVkaXJlY3RlZCB0byB0aGUgbG9naW4gcGFnZS4KICAgICAgICAgICAgbmV4dCgiL2xvZ2luP3JlZGlyZWN0PSIuY29uY2F0KHRvLnBhdGgpKTsKICAgICAgICAgICAgTlByb2dyZXNzLmRvbmUoKTsKICAgICAgICAgIH0KICAgICAgICBjYXNlIDM1OgogICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICB9CiAgICB9LCBfY2FsbGVlLCBudWxsLCBbWzE0LCAyNV1dKTsKICB9KSk7CiAgcmV0dXJuIGZ1bmN0aW9uIChfeCwgX3gyLCBfeDMpIHsKICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfTsKfSgpKTsKcm91dGVyLmFmdGVyRWFjaChmdW5jdGlvbiAoKSB7CiAgLy8gZmluaXNoIHByb2dyZXNzIGJhcgogIE5Qcm9ncmVzcy5kb25lKCk7Cn0pOw=="},{"version":3,"names":["router","store","Message","NProgress","getToken","getPageTitle","configure","showSpinner","whiteList","beforeEach","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","to","from","next","hasToken","hasRoles","roles","accessRoutes","wrap","_callee$","_context","prev","start","document","title","meta","path","done","getters","length","dispatch","sent","addRoutes","_objectSpread","replace","t0","error","message","concat","indexOf","stop","_x","_x2","_x3","apply","arguments","afterEach"],"sources":["/Users/shl/Desktop/Moss罗杰软工/frontend/buaa2022-db/src/permission.js"],"sourcesContent":["import router from './router'\nimport store from './store'\nimport {Message} from 'element-ui'\nimport NProgress from 'nprogress' // progress bar\nimport 'nprogress/nprogress.css' // progress bar style\nimport {getToken} from '@/utils/auth' // get token from cookie\nimport getPageTitle from '@/utils/get-page-title'\n\nNProgress.configure({showSpinner: false}) // NProgress Configuration\n\nconst whiteList = ['/index2', '/login', '/auth-redirect'] // no redirect whitelist\n\nrouter.beforeEach(async (to, from, next) => {\n  // start progress bar\n  NProgress.start()\n\n  // set page title\n  document.title = getPageTitle(to.meta.title)\n\n  // determine whether the user has logged in\n  const hasToken = getToken()\n\n  if (hasToken) {\n    if (to.path === '/login') {\n      // if is logged in, redirect to the home page\n      next({path: '/'})\n      NProgress.done() // hack: https://github.com/PanJiaChen/vue-element-admin/pull/2939\n    } else {\n      // determine whether the user has obtained his permission roles through getInfo\n      const hasRoles = store.getters.roles && store.getters.roles.length > 0\n      if (hasRoles) {\n        next()\n      } else {\n        try {\n          // get user info\n          // note: roles must be a object array! such as: ['admin'] or ,['developer','editor']\n         // const {roles} =\n          await store.dispatch('user/forceGetInfo')\n          const roles = store.getters.roles\n          // generate accessible routes map based on roles\n          const accessRoutes = await store.dispatch('permission/generateRoutes', roles)\n\n          // dynamically add accessible routes\n          router.addRoutes(accessRoutes)\n\n          // hack method to ensure that addRoutes is complete\n          // set the replace: true, so the navigation will not leave a history record\n          next({...to, replace: true})\n        } catch (error) {\n          // remove token and go to login page to re-login\n          await store.dispatch('user/resetToken')\n          Message.error({message: error || 'Has Error'})\n          next(`/login?redirect=${to.path}`)\n          NProgress.done()\n        }\n      }\n    }\n  } else {\n    /* has no token*/\n\n    if (whiteList.indexOf(to.path) !== -1) {\n      // in the free login whitelist, go directly\n      next()\n    } else {\n      // other pages that do not have permission to access are redirected to the login page.\n      next(`/login?redirect=${to.path}`)\n      NProgress.done()\n    }\n  }\n})\n\nrouter.afterEach(() => {\n  // finish progress bar\n  NProgress.done()\n})\n"],"mappings":"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"}]}