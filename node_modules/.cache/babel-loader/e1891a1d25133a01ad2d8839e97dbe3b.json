{"remainingRequest":"/Users/shl/Desktop/Moss罗杰软工/frontend/buaa2022-db/node_modules/babel-loader/lib/index.js!/Users/shl/Desktop/Moss罗杰软工/frontend/buaa2022-db/node_modules/eslint-loader/index.js??ref--13-0!/Users/shl/Desktop/Moss罗杰软工/frontend/buaa2022-db/src/store/modules/permission.js","dependencies":[{"path":"/Users/shl/Desktop/Moss罗杰软工/frontend/buaa2022-db/src/store/modules/permission.js","mtime":1680943788616},{"path":"/Users/shl/Desktop/Moss罗杰软工/frontend/buaa2022-db/babel.config.js","mtime":1680943788576},{"path":"/Users/shl/Desktop/Moss罗杰软工/frontend/buaa2022-db/node_modules/cache-loader/dist/cjs.js","mtime":1680943968418},{"path":"/Users/shl/Desktop/Moss罗杰软工/frontend/buaa2022-db/node_modules/babel-loader/lib/index.js","mtime":1680943970633},{"path":"/Users/shl/Desktop/Moss罗杰软工/frontend/buaa2022-db/node_modules/eslint-loader/index.js","mtime":1680943968496}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL1VzZXJzL3NobC9EZXNrdG9wL01vc3NcdTdGNTdcdTY3NzBcdThGNkZcdTVERTUvZnJvbnRlbmQvYnVhYTIwMjItZGIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0IHsgYXN5bmNSb3V0ZXMsIGNvbnN0YW50Um91dGVzIH0gZnJvbSAnQC9yb3V0ZXInOwoKLyoqCiAqIFVzZSBtZXRhLnJvbGUgdG8gZGV0ZXJtaW5lIGlmIHRoZSBjdXJyZW50IHVzZXIgaGFzIHBlcm1pc3Npb24KICogQHBhcmFtIHJvbGVzCiAqIEBwYXJhbSByb3V0ZQogKi8KZnVuY3Rpb24gaGFzUGVybWlzc2lvbihyb2xlcywgcm91dGUpIHsKICBpZiAocm91dGUubWV0YSAmJiByb3V0ZS5tZXRhLnJvbGVzKSB7CiAgICByZXR1cm4gcm9sZXMuc29tZShmdW5jdGlvbiAocm9sZSkgewogICAgICByZXR1cm4gcm91dGUubWV0YS5yb2xlcy5pbmNsdWRlcyhyb2xlKTsKICAgIH0pOwogIH0gZWxzZSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn0KCi8qKgogKiBGaWx0ZXIgYXN5bmNocm9ub3VzIHJvdXRpbmcgdGFibGVzIGJ5IHJlY3Vyc2lvbgogKiBAcGFyYW0gcm91dGVzIGFzeW5jUm91dGVzCiAqIEBwYXJhbSByb2xlcwogKi8KZXhwb3J0IGZ1bmN0aW9uIGZpbHRlckFzeW5jUm91dGVzKHJvdXRlcywgcm9sZXMpIHsKICB2YXIgcmVzID0gW107CiAgcm91dGVzLmZvckVhY2goZnVuY3Rpb24gKHJvdXRlKSB7CiAgICB2YXIgdG1wID0gX29iamVjdFNwcmVhZCh7fSwgcm91dGUpOwogICAgaWYgKGhhc1Blcm1pc3Npb24ocm9sZXMsIHRtcCkpIHsKICAgICAgaWYgKHRtcC5jaGlsZHJlbikgewogICAgICAgIHRtcC5jaGlsZHJlbiA9IGZpbHRlckFzeW5jUm91dGVzKHRtcC5jaGlsZHJlbiwgcm9sZXMpOwogICAgICB9CiAgICAgIHJlcy5wdXNoKHRtcCk7CiAgICB9CiAgfSk7CiAgcmV0dXJuIHJlczsKfQp2YXIgc3RhdGUgPSB7CiAgcm91dGVzOiBjb25zdGFudFJvdXRlcywKICBhZGRSb3V0ZXM6IFtdCn07CnZhciBtdXRhdGlvbnMgPSB7CiAgU0VUX1JPVVRFUzogZnVuY3Rpb24gU0VUX1JPVVRFUyhzdGF0ZSwgcm91dGVzKSB7CiAgICBzdGF0ZS5hZGRSb3V0ZXMgPSByb3V0ZXM7CiAgICBzdGF0ZS5yb3V0ZXMgPSBjb25zdGFudFJvdXRlcy5jb25jYXQocm91dGVzKTsKICB9Cn07CnZhciBhY3Rpb25zID0gewogIGdlbmVyYXRlUm91dGVzOiBmdW5jdGlvbiBnZW5lcmF0ZVJvdXRlcyhfcmVmLCByb2xlcykgewogICAgdmFyIGNvbW1pdCA9IF9yZWYuY29tbWl0OwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgIHZhciBhY2Nlc3NlZFJvdXRlczsKICAgICAgaWYgKHJvbGVzLmluY2x1ZGVzKCdhZG1pbicpKSB7CiAgICAgICAgYWNjZXNzZWRSb3V0ZXMgPSBhc3luY1JvdXRlcyB8fCBbXTsKICAgICAgICBjb25zb2xlLmxvZygiSSBrbm93IGl0IGlzIGFuIGFkbWluIik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYWNjZXNzZWRSb3V0ZXMgPSBmaWx0ZXJBc3luY1JvdXRlcyhhc3luY1JvdXRlcywgcm9sZXMpOwogICAgICB9CiAgICAgIGNvbW1pdCgnU0VUX1JPVVRFUycsIGFjY2Vzc2VkUm91dGVzKTsKICAgICAgY29uc29sZS5sb2coYWNjZXNzZWRSb3V0ZXMpOwogICAgICByZXNvbHZlKGFjY2Vzc2VkUm91dGVzKTsKICAgIH0pOwogIH0KfTsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWVzcGFjZWQ6IHRydWUsCiAgc3RhdGU6IHN0YXRlLAogIG11dGF0aW9uczogbXV0YXRpb25zLAogIGFjdGlvbnM6IGFjdGlvbnMKfTs="},{"version":3,"names":["asyncRoutes","constantRoutes","hasPermission","roles","route","meta","some","role","includes","filterAsyncRoutes","routes","res","forEach","tmp","_objectSpread","children","push","state","addRoutes","mutations","SET_ROUTES","concat","actions","generateRoutes","_ref","commit","Promise","resolve","accessedRoutes","console","log","namespaced"],"sources":["/Users/shl/Desktop/Moss罗杰软工/frontend/buaa2022-db/src/store/modules/permission.js"],"sourcesContent":["import { asyncRoutes, constantRoutes } from '@/router'\n\n/**\n * Use meta.role to determine if the current user has permission\n * @param roles\n * @param route\n */\nfunction hasPermission(roles, route) {\n  if (route.meta && route.meta.roles) {\n    return roles.some(role => route.meta.roles.includes(role))\n  } else {\n    return true\n  }\n}\n\n/**\n * Filter asynchronous routing tables by recursion\n * @param routes asyncRoutes\n * @param roles\n */\nexport function filterAsyncRoutes(routes, roles) {\n  const res = []\n\n  routes.forEach(route => {\n    const tmp = { ...route }\n    if (hasPermission(roles, tmp)) {\n      if (tmp.children) {\n        tmp.children = filterAsyncRoutes(tmp.children, roles)\n      }\n      res.push(tmp)\n    }\n  })\n\n  return res\n}\n\nconst state = {\n  routes: constantRoutes,\n  addRoutes: []\n}\n\nconst mutations = {\n  SET_ROUTES: (state, routes) => {\n    state.addRoutes = routes\n    state.routes = constantRoutes.concat(routes)\n  }\n}\n\nconst actions = {\n  generateRoutes({ commit }, roles) {\n    return new Promise(resolve => {\n      let accessedRoutes\n      if (roles.includes('admin')) {\n        accessedRoutes = asyncRoutes || []\n        console.log(\"I know it is an admin\")\n      } else {\n        accessedRoutes = filterAsyncRoutes(asyncRoutes, roles)\n      }\n      commit('SET_ROUTES', accessedRoutes)\n      console.log(accessedRoutes)\n      resolve(accessedRoutes)\n    })\n  }\n}\n\nexport default {\n  namespaced: true,\n  state,\n  mutations,\n  actions\n}\n"],"mappings":";;;;;;AAAA,SAASA,WAAW,EAAEC,cAAc,QAAQ,UAAU;;AAEtD;AACA;AACA;AACA;AACA;AACA,SAASC,aAAaA,CAACC,KAAK,EAAEC,KAAK,EAAE;EACnC,IAAIA,KAAK,CAACC,IAAI,IAAID,KAAK,CAACC,IAAI,CAACF,KAAK,EAAE;IAClC,OAAOA,KAAK,CAACG,IAAI,CAAC,UAAAC,IAAI;MAAA,OAAIH,KAAK,CAACC,IAAI,CAACF,KAAK,CAACK,QAAQ,CAACD,IAAI,CAAC;IAAA,EAAC;EAC5D,CAAC,MAAM;IACL,OAAO,IAAI;EACb;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASE,iBAAiBA,CAACC,MAAM,EAAEP,KAAK,EAAE;EAC/C,IAAMQ,GAAG,GAAG,EAAE;EAEdD,MAAM,CAACE,OAAO,CAAC,UAAAR,KAAK,EAAI;IACtB,IAAMS,GAAG,GAAAC,aAAA,KAAQV,KAAK,CAAE;IACxB,IAAIF,aAAa,CAACC,KAAK,EAAEU,GAAG,CAAC,EAAE;MAC7B,IAAIA,GAAG,CAACE,QAAQ,EAAE;QAChBF,GAAG,CAACE,QAAQ,GAAGN,iBAAiB,CAACI,GAAG,CAACE,QAAQ,EAAEZ,KAAK,CAAC;MACvD;MACAQ,GAAG,CAACK,IAAI,CAACH,GAAG,CAAC;IACf;EACF,CAAC,CAAC;EAEF,OAAOF,GAAG;AACZ;AAEA,IAAMM,KAAK,GAAG;EACZP,MAAM,EAAET,cAAc;EACtBiB,SAAS,EAAE;AACb,CAAC;AAED,IAAMC,SAAS,GAAG;EAChBC,UAAU,EAAE,SAAAA,WAACH,KAAK,EAAEP,MAAM,EAAK;IAC7BO,KAAK,CAACC,SAAS,GAAGR,MAAM;IACxBO,KAAK,CAACP,MAAM,GAAGT,cAAc,CAACoB,MAAM,CAACX,MAAM,CAAC;EAC9C;AACF,CAAC;AAED,IAAMY,OAAO,GAAG;EACdC,cAAc,WAAAA,eAAAC,IAAA,EAAarB,KAAK,EAAE;IAAA,IAAjBsB,MAAM,GAAAD,IAAA,CAANC,MAAM;IACrB,OAAO,IAAIC,OAAO,CAAC,UAAAC,OAAO,EAAI;MAC5B,IAAIC,cAAc;MAClB,IAAIzB,KAAK,CAACK,QAAQ,CAAC,OAAO,CAAC,EAAE;QAC3BoB,cAAc,GAAG5B,WAAW,IAAI,EAAE;QAClC6B,OAAO,CAACC,GAAG,CAAC,uBAAuB,CAAC;MACtC,CAAC,MAAM;QACLF,cAAc,GAAGnB,iBAAiB,CAACT,WAAW,EAAEG,KAAK,CAAC;MACxD;MACAsB,MAAM,CAAC,YAAY,EAAEG,cAAc,CAAC;MACpCC,OAAO,CAACC,GAAG,CAACF,cAAc,CAAC;MAC3BD,OAAO,CAACC,cAAc,CAAC;IACzB,CAAC,CAAC;EACJ;AACF,CAAC;AAED,eAAe;EACbG,UAAU,EAAE,IAAI;EAChBd,KAAK,EAALA,KAAK;EACLE,SAAS,EAATA,SAAS;EACTG,OAAO,EAAPA;AACF,CAAC"}]}