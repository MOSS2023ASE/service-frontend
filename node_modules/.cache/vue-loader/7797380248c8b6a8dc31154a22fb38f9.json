{"remainingRequest":"/Users/shl/Desktop/Moss罗杰软工/frontend/buaa2022-db/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/shl/Desktop/Moss罗杰软工/frontend/buaa2022-db/src/views/Autodish/autoDish.vue?vue&type=style&index=0&id=35be0125&scoped=true&lang=css&","dependencies":[{"path":"/Users/shl/Desktop/Moss罗杰软工/frontend/buaa2022-db/src/views/Autodish/autoDish.vue","mtime":1680943788619},{"path":"/Users/shl/Desktop/Moss罗杰软工/frontend/buaa2022-db/node_modules/css-loader/dist/cjs.js","mtime":1680943968683},{"path":"/Users/shl/Desktop/Moss罗杰软工/frontend/buaa2022-db/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1680943969527},{"path":"/Users/shl/Desktop/Moss罗杰软工/frontend/buaa2022-db/node_modules/postcss-loader/src/index.js","mtime":1680943968838},{"path":"/Users/shl/Desktop/Moss罗杰软工/frontend/buaa2022-db/node_modules/cache-loader/dist/cjs.js","mtime":1680943968418},{"path":"/Users/shl/Desktop/Moss罗杰软工/frontend/buaa2022-db/node_modules/vue-loader/lib/index.js","mtime":1680943969372}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouZWwtc2VsZWN0IC5lbC1pbnB1dCB7CiAgd2lkdGg6IDEzMHB4Owp9CgouaW5wdXQtd2l0aC1zZWxlY3QgLmVsLWlucHV0LWdyb3VwX19wcmVwZW5kIHsKICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmOwp9CgouZWwtYnV0dG9uIHsKICBjb2xvcjogd2hpdGU7Cn0K"},{"version":3,"sources":["autoDish.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiQA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA","file":"autoDish.vue","sourceRoot":"src/views/Autodish","sourcesContent":["<template>\n  <div>\n    <el-form ref=\"form\" :model=\"form\" :rules=\"rules\">\n      <el-form-item\n        label=\"预期价格\"\n        prop=\"price\"\n      >\n        <el-input type=\"price\" v-model.number=\"form.price\" autocomplete=\"off\"></el-input>\n      </el-form-item>\n      <el-form-item label=\"喜好口味\" prop=\"dish_tag\">\n        <el-checkbox-group v-model=\"form.dish_tag\">\n          <el-checkbox label=\"酸甜\" name=\"favor\"></el-checkbox>\n          <el-checkbox label=\"辣味\" name=\"favor\"></el-checkbox>\n          <el-checkbox label=\"清淡\" name=\"favor\"></el-checkbox>\n          <el-checkbox label=\"苦香\" name=\"favor\"></el-checkbox>\n        </el-checkbox-group>\n      </el-form-item>\n      <el-form-item label=\"喜好餐厅\" prop=\"canteen_name\">\n        <el-select v-model=\"form.canteen_name\" placeholder=\"请选择喜好餐厅\">\n          <el-option\n            v-for=\"item in this.canteenOptions\"\n            :key=\"item.canteen_id\"\n            :label=\"item.canteen_name\"\n            :value=\"item.canteen_name\"\n          />\n        </el-select>\n      </el-form-item>\n    </el-form>\n    <div style=\"margin-top: 15px;text-align: right\">\n      <el-row>\n        <el-button type=\"success\" round @click=\"get_auto_result('form')\">智能生成</el-button>\n        <el-button type=\"primary\" round @click=\"showautorec\">定制记录</el-button>\n      </el-row>\n    </div>\n    <v-app>\n      <v-data-iterator\n        :items=\"autodish\"\n        :items-per-page=\"itemsPerPage\"\n        :page=\"page\"\n        no-data-text=\"暂未生成\"\n        hide-default-footer\n      >\n        <template v-slot:default=\"props\">\n          <v-row>\n            <v-col\n              v-for=\"item in props.items\"\n              :key=\"item.id\"\n              cols=\"12\"\n            >\n              <foodcard2\n                :dish_id=\"item.dish_id\"\n                :dish_star=\"item.dish_star\"\n                :dish_name=\"item.dish_name\"\n                :dish_info=\"item.dish_info\"\n                :canteen_name=\"item.canteen_name\"\n                :dish_price=\"item.dish_price\"\n                :dish_tag=\"item.dish_tag\"\n                :dish_pic=\"item.dish_pic\"\n              ></foodcard2>\n\n            </v-col>\n          </v-row>\n        </template>\n      </v-data-iterator>\n      <v-pagination\n        v-model=\"page\"\n        :length=\"numberOfPages\"\n        :total-visible=\"7\"\n        style=\"margin: 30px 0 25px 10px;\"\n      ></v-pagination>\n      <v-dialog v-model=\"autorec\" width=\"600px\">\n        <v-card\n          max-width=\"600\"\n          class=\"mx-auto\"\n        >\n          <v-toolbar\n            color=\"orange lighten-1\"\n            dark\n          >\n            <v-app-bar-nav-icon></v-app-bar-nav-icon>\n\n            <v-toolbar-title>定制记录</v-toolbar-title>\n\n            <v-spacer></v-spacer>\n\n            <v-btn icon>\n              <v-icon>mdi-magnify</v-icon>\n            </v-btn>\n          </v-toolbar>\n          <v-list three-line>\n            <template v-for=\"(item, index) in items\">\n              <v-divider\n                v-if=\"item.divider\"\n                :key=\"index\"\n                :inset=\"item.inset\"\n              ></v-divider>\n\n              <v-list-item\n                v-else\n                :key=\"item.create_time\"\n              >\n\n                <v-list-item-content>\n                  <v-list-item-title>记录时间：{{ slicecreate_time(item.create_time) }}</v-list-item-title>\n                  <v-list-item-subtitle>生成菜品名称：{{ item.dishes_name }}</v-list-item-subtitle>\n                  <v-list-item-subtitle>预期价格：{{ item.price }}</v-list-item-subtitle>\n                  <v-list-item-subtitle>喜好口味：{{ item.tags }}</v-list-item-subtitle>\n                  <v-list-item-subtitle>喜好餐厅：{{ item.canteen_name }}</v-list-item-subtitle>\n                </v-list-item-content>\n              </v-list-item>\n            </template>\n          </v-list>\n\n        </v-card>\n      </v-dialog>\n    </v-app>\n  </div>\n</template>\n\n<script>\n\nimport foodcard2 from \"@/views/HomeView/components/foodcard2\";\nimport {fetchResult, fetchAutoRec} from \"@/api/autoDish\";\nimport {getCanteenList} from \"@/api/canteen\";\n\nconst tasteOptions = [\n  {key: '酸甜', display_name: '酸甜'},\n  {key: '辣味', display_name: '辣味'},\n  {key: '清淡', display_name: '清淡'},\n  {key: '苦香', display_name: '苦香'}\n]\nexport default {\n  name: \"autoDish\",\n  components: {foodcard2},\n  data() {\n\n    return {\n      autorec: false,\n      form: {\n        price: 10,\n        dish_tag: [],\n        canteen_name: '',\n        user_id: this.$store.state.user.user_id,\n      },\n      items: [],\n      rules: {\n        price: [\n          {required: true, message: '价格不能为空'},\n          {type: 'number', message: '价格必须为数字整数值'}\n        ],\n        favor: [\n          {type: 'array', required: true, message: '请至少选择一个喜好口味', trigger: 'change'}\n        ],\n      },\n      canteenOptions: [],\n      list_length: 0,\n      rec_list_length: 0,\n      autodish: [],\n      page: 1,\n      itemsPerPage: 4,\n    }\n  },\n  created() {\n    this.getCanteenList()\n    this.getautoreclist()\n  },\n\n  computed: {\n    numberOfPages() {\n      return Math.ceil(this.list_length / this.itemsPerPage)\n    },\n  },\n  watch: {\n    isUpdating(val) {\n      if (val) {\n        setTimeout(() => (this.isUpdating = false), 3000)\n      }\n    },\n  },\n  methods: {\n    slicecreate_time(str) {\n      return str.substring(0, 10)\n    },\n    getautoreclist() {\n      let Did = {\n        user_id: this.$store.state.user.user_id\n      }\n      fetchAutoRec(Did).then(response => {\n        let originData = response.data.record_list\n        this.rec_list_length = response.data.list_length\n        let divide = {divider: true, inset: true}\n        let o\n        this.$nextTick(() => {\n          this.items = []\n          for (o in originData) {\n            this.items.push(originData[o])\n            this.items.push(divide)\n          }\n          console.log(this.items)\n          setTimeout(() => {\n            this.listLoading = false\n          }, 1.5 * 1000)\n        })\n      })\n    },\n    showautorec() {\n      this.autorec = true\n    },\n    getCanteenList() {\n      this.listLoading = true\n      getCanteenList().then((res) => {\n        this.canteenOptions = res.data.canteen_list\n        this.canteenOptions.push({canteen_id: 0, canteen_name: '随机'})\n      })\n    },\n    get_auto_result(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          this.form.favor = []\n          fetchResult(this.form).then(response => {\n            this.list_length = response.data.list_length\n            this.autodish = response.data.dish_list\n            console.log(this.autodish)\n            this.getautoreclist()\n            this.$notify({\n              title: 'Success',\n              message: '生成成功',\n              type: 'success',\n              duration: 2000\n            })\n          }).catch(() => {\n            this.$notify({\n              title: 'Fail',\n              message: '没有符合要求的定制菜单',\n              type: 'warning',\n              duration: 2000\n            })\n          })\n        } else {\n          console.log('error submit!!');\n          this.$notify({\n            title: 'UnSuccess',\n            message: '生成失败，请您填写合法数据',\n            type: 'warning',\n            duration: 2000\n          })\n          return false;\n        }\n      });\n\n    }\n  },\n\n}\n</script>\n\n<style scoped>\n.el-select .el-input {\n  width: 130px;\n}\n\n.input-with-select .el-input-group__prepend {\n  background-color: #fff;\n}\n\n.el-button {\n  color: white;\n}\n</style>\n"]}]}